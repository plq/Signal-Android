mkdir image-build-ctx
cd image-build-ctx
docker build --file ../DockerFile --tag signal-android .
cd ..

docker run \
    --name signal \
    --rm \
    --interactive \
    --tty \ 
    --volum e $(pwd)/apk-from-google-play-store:/signal-build/apk-from-google-play-store \
    --workdir /signal-build \
    signal-android

# inside docker
git clone https://github.com/plq/Signal-Android.git
cd Signal-Android
git checkout 4_64_7
./gradlew clean assemblePlayRelease --exclude-task signProductionPlayRelease
find -name *.apk


cd app/build/outputs/apk
keytool -genkey -v -keystore signaldevel.keystore -alias SignalDevel -keyalg RSA -keysize 4096
for f in Signal-play-armeabi-v7a-release-unsigned-*.apk; do
    sf=${f/unsigned/signed}
    cp -vf $f $sf
    jarsigner -verbose -keystore signaldevel.keystore $sf SignalDevel
done
